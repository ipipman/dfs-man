# dfs-man
从零开始, 手写DFS文件系统框架

## 引言

在分布式环境中，设计一个高效且可靠的文件系统是至关重要的。本设计聚焦于实现文件的高效上传与下载、元数据管理、文件唯一性检查、目录与文件分块存储，以及上传后的多机同步功能。

## 核心功能实现

### 文件上传与下载

- **上传流程**:
    - 接收客户端上传的文件，将其分块存储。
    - 生成并存储文件的MD5校验码，确保文件的唯一性和完整性。
    - 更新文件元数据，包括文件名、大小、类型、存储位置等信息。
    - 触发同步机制，将文件分块同步至备份服务器。

- **下载流程**:
    - 根据文件名检索元数据，获取文件存储位置。
    - 从存储节点读取文件分块，合并后返回给客户端。

### 元数据管理与文件唯一性

- **元数据存储**: 使用数据库或键值存储系统来记录文件的元数据，包括文件的MD5校验码。
- **文件唯一性**: 上传时计算文件的MD5值，与现有元数据中的MD5值对比，避免重复存储相同文件。

### 目录与文件分块存储

- **目录结构**: 采用层次化的目录结构，便于管理和检索。
- **文件分块**: 大文件被分割成多个小块，每个块独立存储，提高存储效率和数据读取速度。

### 多机同步机制

- **同步策略**: 实现同步和异步两种同步机制。
    - **同步**: 上传完成后立即向备份服务器发送文件分块，确保数据的即时可用性。
    - **异步**: 通过消息队列延迟同步，减轻主服务器压力，提高系统吞吐量。

## 总结

本DFS设计通过精细的文件上传下载流程、元数据管理、文件唯一性检查、目录与文件分块存储，以及灵活的多机同步机制，构建了一个高效、可靠且可扩展的文件系统。这不仅满足了大规模数据存储的需求，同时也保障了数据的完整性和系统的稳定性。
